post:
  summary: Async Submission
  description: |
    Perform a submission to BioStudies using the given page tab. Please have the following in mind:
    * The given page tab should match the format specified in the SUBMISSION_TYPE header
    * Regardless of the chosen format to submit, the page tab document in the response will always be returned in JSON format
    * Any referenced file should be either placed in the user folder or attached to the request using the Files parameter. Please have in mind that the amount of files that can be directly attached to the request is limited, if the submission has too many files, please place them in the user directory.
    * If no accession number is provided, a new submission will be created and the corresponding accession number will be generated
    * If an accession number is provided, the submission will be treated as a resubmission which will perform an update

  tags:
    - Async Submissions

  parameters:
    - name: Content-Type
      in: header
      schema:
        type: string
        enum:
          - multipart/form-data
          - application/json
    - name: Submission_Type
      in: header
      schema:
        type: string
        enum:
          - application/json
          - text/plain
          - text/xml
    - name: X-Session-Token
      in: header
      schema:
        type: string
      example: <auth-token>

    - in: query
      name: onBehalf
      description:
        In case the submission is performed on behalf of another user, the submission owner's email should be placed in
        this parameter.
      required: false
      schema:
        type: string

    - in: query
      name: onBehalfRequest
      description:
        This param is used if the submission is performed on behalf of another user. It's not required.
      schema:
        type: object
        required:
          - userEmail
        properties:
          userEmail:
            type: string
            description:
              The submission owner's email should be placed in this parameter.
          userName:
            type: string
          register:
            type: boolean
            description:
              This parameter indicates whether a new user should be registered in case the given owner doesn't exist.

    - in: query
      name: preferredSources
      schema:
        type: array
        items:
          type: string
          example:
            - FIRE
            - SUBMISSION
            - USER_SPACE
    - in: query
      name: attributes
      schema:
        type: array
        items:
          type: object
          required:
            - name
          properties:
            name:
              type: string
            value:
              type: string
    - in: query
      name: storageMode
      schema:
        type: string
        enum:
          - FIRE
          - NFS

  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          example:
            accno: <accNo>
            attributes:
              - name: Title
                value: <submission-title>
              - name: ReleaseDate
                value: <release-date>
            section:
              accno: <accno-section>
              type: <section-type>
              attributes:
                - name: File List
                  value: <fileList-fileName>
      multipart/form-data:
        schema:
          type: object
          required:
            - submission
            - fileMode
          properties:
            submission:
              type: string
              example: |-
                {
                    "accno": <accNo>,
                    "attributes" :[{
                        "name" : Title,
                        "value" : <submission-title>
                    },
                    {
                        "name" : "ReleaseDate",
                        "value" : "2021-05-30"
                    }],
                    "section" : {
                        "accno" : <accno-section>,
                        "type" : <section-type>,
                        "attributes" : [{
                                        "name" : File List,
                                        "value" : <fileList-fileName>
                                    }]
                    }
                }
            fileMode:
              type: string
              example: COPY
            Files:
              type: array
              items:
                type: string
                format: binary

  responses:
    200:
      description: OK
    401:
      description: Caused by an invalid X-SESSION-TOKEN
